# Mirae Asset Large & Midcap Fund - Download Guide

## ‚ö†Ô∏è Important: Manual Download Required

**Unlike Canara Robeco, Mirae Asset does NOT provide direct download URLs for portfolio files.**

The automated script `scripts/mirae_auto_download.py` has been created but **cannot currently auto-download** because:

- Mirae Asset website uses dynamic content loading
- Portfolio files require interactive website navigation
- No direct URL pattern exists for downloads

---

## üì• Manual Download Process

### **Step 1: Visit the Portfolio Page**

Go to: https://www.miraeassetmf.co.in/downloads/portfolio

### **Step 2: Navigate to Monthly Portfolio**

1. Click on **"Monthly Portfolio"** tab
2. Find **"Mirae Asset Large & Midcap Fund"** in the list
3. Select the month you want (e.g., **January 2026**)
4. Click the **Download** button

### **Step 3: Save the File**

Save the downloaded file to:

```
d:\mffactsheet\excel-data\mirae-asset\
```

**Naming convention:**

- Format: `maebf-{month}{year}.xlsx` or `maebf_{month}{year}.xlsx`
- Examples:
  - `maebf-jan2026.xlsx`
  - `maebf_jan2026.xlsx`
  - `maebf-january2026.xlsx`

### **Step 4: Extract Data**

After downloading, run the extraction script:

```powershell
.\venv\Scripts\python.exe scripts\extract_all_funds.py
```

This will:

- Process the new Excel file
- Generate JSON data in `data/` folder
- Make it available in the UI

---

## üîÑ Current Workflow

### **For January 2026:**

1. **Manual Download** (from website)
   - Visit: https://www.miraeassetmf.co.in/downloads/portfolio
   - Download: Mirae Asset Large & Midcap Fund - January 2026
   - Save to: `excel-data/mirae-asset/maebf-jan2026.xlsx`

2. **Auto-Extract** (one command)

   ```powershell
   .\venv\Scripts\python.exe scripts\extract_all_funds.py
   ```

3. **Refresh Browser**
   - January 2026 data now visible in UI ‚úÖ

---

## üìä File Naming Examples

**Existing files in your folder:**

```
maebf-dec2025.xlsx      ‚úì (December 2025)
maebf-july2025.xlsx     ‚úì (July 2025)
maebf-oct2025.xlsx      ‚úì (October 2025)
maebf_aug2025.xlsx      ‚úì (August 2025)
maebf_nov2025.xlsx      ‚úì (November 2025)
maebf_sept2025.xlsx     ‚úì (September 2025)
```

**For January 2026, use:**

```
maebf-jan2026.xlsx      ‚úì (Recommended)
maebf_jan2026.xlsx      ‚úì (Also works)
```

---

## ü§ñ Why No Auto-Download?

**Technical Root Cause:**
The Mirae Asset website uses **client-side JavaScript rendering** to dynamically load portfolio download links. This means:

1. **HTML is Empty**: When you fetch the page with `requests` or `curl`, you get an HTML skeleton with no download links
2. **JavaScript Builds UI**: The actual download links are generated by JavaScript running in the browser
3. **No API Access**: The website doesn't expose a public API for programmatic downloads

**What We See vs What Browser Sees:**

| Method           | What It Gets                              |
| ---------------- | ----------------------------------------- |
| `requests.get()` | Empty HTML with `<div id="app"></div>`    |
| Browser          | Fully rendered page with download buttons |
| BeautifulSoup    | No links (0 Excel files found)            |
| Browser DevTools | Download links visible in DOM             |

**Attempted Solutions:**

- Direct URL patterns (302 redirects to login/error page)
- BeautifulSoup scraping with pagination (0 links in raw HTML)
- Pattern matching on known file formats (files not in HTML source)
- API endpoint discovery (no public API available)

**Why Canara Robeco Works But Mirae Asset Doesn't:**

- **Canara Robeco**: Server-side rendering - download links exist in raw HTML
- **Mirae Asset**: Client-side rendering - download links only exist after JavaScript execution

**Possible Solutions (Not Implemented):**

1. **Selenium/Playwright**: Use browser automation to render JavaScript
   - Would work
   - Requires browser driver installation
   - Slower and more resource-intensive
   - More fragile (breaks with website updates)

2. **Reverse Engineer API**: Find internal API calls
   - Would work if API exists
   - Requires authentication/tokens
   - May violate terms of service
   - Breaks when API changes

**Current Solution: Manual Download**
Given the complexity and maintenance burden of browser automation, manual download is the most reliable approach for now.

---

## üîÆ Future Automation Options

### **Option 1: Selenium/Playwright** (Complex)

- Use browser automation to navigate the website
- Click buttons and download files programmatically
- **Pros**: Fully automated
- **Cons**: Requires browser driver, slower, more fragile

### **Option 2: API Reverse Engineering** (Advanced)

- Intercept network requests to find API endpoints
- Replicate API calls in Python
- **Pros**: Fast, reliable
- **Cons**: May break if API changes, requires maintenance

### **Option 3: Manual Download** (Current)

- Download files manually from website
- Run extraction script
- **Pros**: Simple, reliable, works now
- **Cons**: Requires manual step

**Recommendation**: Stick with manual download for now. It takes ~2 minutes per month.

---

## ‚úÖ Quick Reference

### **Download January 2026:**

1. Go to: https://www.miraeassetmf.co.in/downloads/portfolio
2. Download: Mirae Asset Large & Midcap Fund - January 2026
3. Save as: `excel-data/mirae-asset/maebf-jan2026.xlsx`
4. Run: `.\venv\Scripts\python.exe scripts\extract_all_funds.py`
5. Refresh browser ‚úÖ

### **Verify Extraction:**

Check if JSON file was created:

```powershell
Get-ChildItem data\MiraeAssetLargeAndMidcapFund-January-2026.json
```

---

## üìù Notes

- **Canara Robeco**: Fully automated ‚úÖ
- **Mirae Asset**: Manual download required ‚ö†Ô∏è
- **Extraction**: Always automated for both funds ‚úÖ
- **Time Required**: ~2 minutes per month for manual download
- **Frequency**: Monthly (around 5th of each month)

---

## üÜò Troubleshooting

### **File not extracting?**

Check filename matches pattern:

- `maebf-{month}{year}.xlsx`
- Month: jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec
- Year: 2026

### **Wrong fund downloaded?**

Make sure you download **"Mirae Asset Large & Midcap Fund"**, not:

- Large Cap Fund
- Mid Cap Fund
- Emerging Bluechip Fund

### **Extraction fails?**

Check the Excel file:

- Should have a sheet named "MAEBF"
- Should contain holdings data
- File size should be > 50 KB

---

## üìû Need Help?

If you want to implement automated download:

1. Consider using Selenium/Playwright for browser automation
2. Or continue with manual download (recommended for simplicity)
3. Extraction is already automated - no changes needed there

**Current Status:**

- ‚úÖ Script created: `scripts/mirae_auto_download.py`
- ‚ö†Ô∏è Manual download required (website limitation)
- ‚úÖ Auto-extraction working
- ‚úÖ Documentation complete
